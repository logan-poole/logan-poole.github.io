<!doctype html>
<html lang="en">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Pinged â€” Admin Users</title>

    <!-- Site-wide styles & theme -->
    <link rel="stylesheet" href="../styles/style.css" />
    <link rel="icon" href="../assets/favicon.ico" type="image/x-icon" />

    <!-- Lightweight layout/style helpers (theme-friendly) -->
    <style>
        :root {
            /* fallbacks if your theme vars aren't present */
            --border: rgba(0, 0, 0, .12);
            --radius: 12px;
            --space: 12px;
            --input-h: 44px;
            --focus: #2dd4bf;
            /* teal-ish; overridden by your theme if defined */
        }

        .row {
            display: flex;
            gap: 12px;
            align-items: center;
        }

        .stack {
            display: flex;
            flex-direction: column;
            gap: 6px;
        }

        .toolbar {
            display: flex;
            gap: 12px;
            flex-wrap: wrap;
            align-items: center;
            margin-bottom: 12px;
        }

        /* Form building blocks */
        .field {
            display: flex;
            flex-direction: column;
            gap: 6px;
        }

        .field label {
            font-weight: 600;
            font-size: .92rem;
            opacity: .9;
        }

        .input,
        input[type="text"],
        input[type="email"],
        input[type="password"],
        select {
            width: 100%;
            height: var(--input-h);
            padding: 10px 12px;
            border-radius: 10px;
            border: 1px solid var(--border);
            background: var(--surface, #fff);
            color: inherit;
            box-shadow: inset 0 1px 0 rgba(0, 0, 0, .02);
            transition: box-shadow .15s ease, border-color .15s ease;
        }

        .input:focus,
        input:focus,
        select:focus {
            outline: 2px solid var(--focus);
            outline-offset: 2px;
            border-color: transparent;
        }

        /* Responsive grids */
        .grid {
            display: grid;
            gap: 12px;
        }

        .grid-2 {
            grid-template-columns: 1fr;
        }

        .grid-3 {
            grid-template-columns: 1fr;
        }

        @media (min-width: 720px) {
            .grid-2 {
                grid-template-columns: repeat(2, 1fr);
            }

            .grid-3 {
                grid-template-columns: repeat(3, 1fr);
            }
        }

        /* Card within card spacing */
        .inner-card {
            border: 1px solid var(--border);
            border-radius: var(--radius);
            padding: 16px;
        }
    </style>
</head>

<body>
    <!-- Top nav -->
    <header class="topnav">
        <a href="../index.html" class="nav-left" style="text-decoration:none;">
            <img src="../assets/logo.png" class="logo small-logo" alt="Pinged Logo" />
            <span class="app-name">Pinged</span>
        </a>
        <nav class="nav-right">
            <a href="../dashboard.html" data-auth="protected">Dashboard</a>
            <a href="../feed.html" data-auth="protected">Feed</a>
            <a href="../map.html" data-auth="protected">Map</a>

            <!-- Shown only if admin (scripts/admin-nav.js) -->
            <a id="nav-admin" href="./admin.html" style="display:none">Admin</a>

            <button id="themeToggle" class="theme-toggle" type="button" aria-label="Toggle theme">ðŸŒ“</button>
        </nav>
    </header>

    <main class="content">
        <section class="card" style="max-width:980px;margin:24px auto;">
            <h1 style="margin-top:0">Users</h1>
            <p class="muted">Requires admin role.</p>

            <div id="auth-hint" class="card" style="display:none">
                <p>You are not signed in. <a href="./dev-login.html?next=users.html">Sign in</a></p>
            </div>

            <!-- Create user -->
            <section class="card" aria-labelledby="create-title">
                <h3 id="create-title" style="margin-top:0">Create user</h3>

                <div class="inner-card">
                    <form id="create-form" class="stack" style="gap:14px;">
                        <!-- Email / Password -->
                        <div class="grid grid-2">
                            <div class="field">
                                <label for="c-email">Email</label>
                                <input id="c-email" class="input" type="email" autocomplete="username" required
                                    placeholder="name@example.com" />
                            </div>
                            <div class="field">
                                <label for="c-password">Password <span class="muted">(optional)</span></label>
                                <input id="c-password" class="input" type="password" autocomplete="new-password"
                                    placeholder="Min 6 characters" />
                            </div>
                        </div>

                        <!-- Metadata -->
                        <div class="grid grid-3">
                            <div class="field">
                                <label for="c-username">Username <span class="muted">(optional)</span></label>
                                <input id="c-username" class="input" type="text" placeholder="e.g. logan" />
                            </div>
                            <div class="field">
                                <label for="c-displayname">Display name <span class="muted">(optional)</span></label>
                                <input id="c-displayname" class="input" type="text" placeholder="e.g. Logan Poole" />
                            </div>
                            <div class="field">
                                <label for="c-avatar">Avatar URL <span class="muted">(optional)</span></label>
                                <input id="c-avatar" class="input" type="text" placeholder="https://â€¦" />
                            </div>
                        </div>

                        <!-- Confirmed + actions -->
                        <div class="row" style="justify-content:space-between; flex-wrap:wrap;">
                            <label class="row" style="gap:8px;">
                                <input id="c-confirmed" type="checkbox" />
                                <span>Email confirmed</span>
                            </label>
                            <div class="row" style="gap:12px;">
                                <button type="submit" class="btn">Create</button>
                                <span id="create-msg" class="muted" aria-live="polite"></span>
                            </div>
                        </div>
                    </form>
                </div>
            </section>

            <!-- List users -->
            <section class="card" aria-labelledby="list-title">
                <div class="toolbar">
                    <h3 id="list-title" style="margin:0;">All users</h3>
                    <span class="spacer" style="flex:1 1 auto;"></span>
                    <input id="q" class="input" placeholder="Search (email, username, display name)"
                        style="max-width:360px;" />
                    <label class="row" style="gap:6px;">Per page
                        <select id="perPage" class="input" style="height:var(--input-h);">
                            <option>25</option>
                            <option selected>50</option>
                            <option>100</option>
                            <option>200</option>
                        </select>
                    </label>
                    <button id="refresh" type="button" class="btn">Refresh</button>
                </div>

                <div id="page-info" class="muted" style="margin-bottom:8px;"></div>
                <div id="users-list"></div>

                <div class="row" style="margin-top:12px;">
                    <button id="prev" type="button" class="btn">Prev</button>
                    <button id="next" type="button" class="btn">Next</button>
                </div>
            </section>
        </section>
    </main>

    <footer>
        <p>&copy; 2025 Pinged. All rights reserved.</p>
    </footer>

    <!-- Scripts (order like the rest of the site) -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script src="../scripts/config.js"></script>
    <script src="../scripts/sb-client.js"></script>

    <!-- Show Admin link/tile only for admins -->
    <script src="../scripts/admin-nav.js"></script>

    <!-- Page logic: calls the admin-users Edge Function etc. -->
    <script src="../scripts/admin-users.js"></script>

    <!-- Optional: profile dropdown + theme toggle like other pages -->
    <script src="../scripts/ui.js" defer></script>
    <script src="../scripts/theme-toggle.js" defer></script>
</body>

</html>